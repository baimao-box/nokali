# Web逻辑越权 2

## 关于支付安全
参考：<https://www.secpulse.com/archives/67080.html>

商品购买一般流程：

`选择商品和数量-选择支付及配送方式-生成订单编号-订单支付选择-完成支付`

常见篡改参数：

商品编号ID，购买价格，购买数量，支付方式，订单号，支付状态等

常见修改方法：

替换支付（支付方式安全问题，修改支付接口，自己给自己付钱），重复支付，最小额支付，负数支付，溢出支付，优惠券支付等

代码审计辅助工具：`TommSea-Tomm`闪电文件搜索



## 逻辑越权：登录凭证安全：
找回重置机制：

客户端回显（验证码直接显示在前端数据包），Response状态值（改返回包），验证码爆破（验证码有效期内穷举，一般是纯数字短验证码），找回流程绕过（比如用一个手机号的验证码对另一个账号进行验证）

接口调用滥用：

短信轰炸，来电轰炸等

## 验证安全：

Token：爆破（找规律），回显（数据包），固定

验证码：爆破，识别，复用，回显，绕过

验证码识别工具：`PKAV-http-fuzz`，`captcha-killer`，`reCAPTCHA`

token测试的基本原则是绕过之后可继续后续测试



## 接口安全问题：

调用，遍历，未授权，篡改等

调用案例：短信轰炸

遍历案例：UID等遍历

callback回调JSONP

参数篡改

有些登录框的callback（用来跳转到登录前页面的函数）部分，会在网页源码里显示目标url，这里如果没有过滤而且不固定跳转目标的话，可能存在XSS

善用burp的爬虫功能，爬虫加搜索“id，ip”之类的参数，可以寻找接口
