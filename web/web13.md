# 反序列化安全

## PHP反序列化：

### 原理：序列化就是将对象转换成字符串。反序列化相反，数据的格式的转换对象的序列化利于对象的保存和传输，也可以让多个文件共享对象。

### 技术：有类的情况（触发魔术方法：`__construct，__destruct，__wakeup，__toString`等），无类的情况

### 利用：真实应用下，各种CTF等

### 危害：SQL注入，代码执行，目录遍历等

### PHP反序列化成因：未对用户输入的序列化字符串进行检测，导致攻击者可以控制反序列化过程，从而导致代码执行，SQL注入，目录遍历等不可控后果。在反序列化的过程中自动触发了某些魔术方法。当进行反序列化的时候就有可能会触发对象中的一些魔术方法。

`serialize()`    将一个对象转换成一个字符串

`unserialize()`    将字符串还原成一个对象

### 触发：unserialize函数的变量可控，文件中存在可利用的类，类中有魔术方法

### 参考：`https://www.cnblogs.com/20175211lyz/p/11403397.html`

```
__construct()    创建对象时触发

__destruct()    对象被销毁时触发

__call()    在对象上下文中调用不可访问的方法时触发

__callStatic()    在静态上下文中调用不可访问的方法时触发

__get()    用于从不可访问的属性读取数据

__set()    用于将数据写入不可访问的属性

__isset()    在不可访问的属性上调用isset()或empty()触发

__unset()    在不可访问的属性上使用unset()时触发

__invoke()    当脚本尝试将对象调用为函数时触发
```


